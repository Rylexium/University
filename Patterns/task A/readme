
A. В гостях у дракона
ограничение по времени на тест 1 секунда
ограничение по памяти на тест 256 мегабайт
вводстандартный ввод
выводстандартный вывод
У Назара в самом разгаре сессия. В перерывах между экзаменами и подготовкой к ним он играет в «Подземелья и драконы». Назар задумался про игровую механику: он может 
проходить уровни либо как герой-воин, либо как герой-альтруист. На каждом уровне подземелья есть некоторый набор комнат сокровищ и комнат чудовищ.

Правила игры таковы: для героя известен его уровень l. Каждая комната #j в подземелье характеризуется ее уровнем dj и наградой rj. Герой проходит комнаты в 
порядке их упоминания, считается, что уровень завершён, когда герой посетил все комнаты.

Герой-воин, проходя через комнату сокровищ #j, забирает оттуда награду, равную dj∗rj. Герой-альтруист, проходя через комнату сокровищ #j, забирает оттуда вдвое 
меньшую награду, т.е. (dj∗rj)/2 (здесь и далее подразумевается целочисленное деление пополам).

Для комнат чудовищ действуют другие правила: герой-воин может забрать из комнаты чудовищ #j всю награду rj, если уровень комнаты dj превосходит уровень героя не 
более, чем на l/2 (половину уровня героя), в противном же случае герой должен оставить в комнате штраф, равный половине награды комнаты. Герой-альтруист может 
приручить чудовище в комнате #j и забрать всю награду rj, если уровень комнаты превышает уровень героя не более, чем в 2 раза. В противном случае герой-альтруист 
убегает из комнаты чудовищ, ничего туда не принося и ничего оттуда не вынося.

В свете подготовки к экзамену по языкам программирования Назар задумался, как такую игровую механику можно реализовать при помощи паттернов проектирования. Ему 
интересно посчитать, сколько сокровищ герой получит (или проиграет), пройдя уровень. Ваша задача — определить суммы выигрыша (или проигрыша) героя-воина и 
героя-альтруиста, обязательно используя для этого ООП и подходящий паттерн проектирования.

Входные данные
В первой строке через пробел даны 3 целых числа t, l, n — тип героя (t=0 соответствует воину, t=1 соответствует альтруисту), 1≤l≤10^3 — уровень героя, 
1≤n≤3⋅10^5 — количество комнат в подземелье.

В каждой из последующих n строк дано описание комнат, состоящее из трех целых чисел через пробел vj dj rj , где vj — тип комнаты (0 для комнаты сокровищ 
и 1 для комнаты чудовищ), 1≤dj≤103 — уровень комнаты, 1≤rj≤103 — награда комнаты.

Выходные данные
Выведите единственное целое число S — суммарную награду, выигранную или проигранную героем в подземелье.

Примеры

входные данные
0 5 4
0 6 9
0 7 7
1 15 13
1 7 20
выходные данные
117

входные данные
1 5 4
0 6 9
0 7 7
1 15 13
1 7 20
выходные данные
71
